:imagesdir: ../../images

== Introduction

Security needs to be an intrinsic part of the hardware, software, and firmware and no longer an afterthought or add-on feature. This document provides a holistic view of the threat model, security analysis, security requirements/ recommendations enabling anyone building a RISC-V platform.


=== Guiding Principles
==== Intrinsic Security

Security has often been a late consideration in the development of systems, hardware, and software. The emergence of exploits such as malware, trojans, the recent Spectre, Meltdown, RAMbleed attacks has resulted in serious financial and reputational losses. This illustrates the need to consider security as an essential component, directly built into a system rather than layered on top.

Unlike other commercial architectures such as X86 and ARM which carry a lot of legacies, RISC-V is a clean slate architecture that can invite a whole lot of new features and solutions both in hardware and software. Below are some key rationale for improving and accelerating RISC-V security

* Clean slate architecture with no legacy support complexity
* Open security model accelerates hardware security innovation
* Opportunity to incorporate industry learnings & best practices for security
* Open governance facilitates collaboration on the best security approach
* Royalty-free model enables wide access to new hardware security solutions thereby democratizing innovation.

==== Zero Trust Model

The Zero Trust model follows the principle "never trust, always verify." The term Zero Trust does not mean "Zero" Trust, but it's quite the opposite. It improves the trust of the whole platform by not having any implicit trust assumptions among various components that are interconnected, but by establishing trust verifying/ authenticating before trusting.

For further details please refer to <<zero_trust>>.


=== Device Model

This diagram below represents a generic device model having an application processor, other IPs, etc. on the left side and root-of-trust on the right side that is isolated from each other. The only communication between the two domains is via a security mailbox.

.Device Model
image::img_0.png[]


The root-of-trust consists of the following elements:

. An immutable code and data that are typically programmed into ROM/ OTP and root-keys either provisioned into OTP or generated every time from the PUF (physical unclonable function) hardware
. A mutable code and data that are updated onto the flash to fix bugs or enhance features, which are authenticated and verified before consumption
. A secure storage mechanism to store secrets/ assets bound to the platform, ex: root-key
. A secure mailbox is the only mechanism to communicate between both the domains


=== Security Goals

The security goals are high-level essential security features for a platform to implement, for the product to be secure and trustworthy. Note that depending on the final usecase, some or all of these goals may not be required and that this will be defined in the mapping to platform specifications (TBD - point to the mapping section later).

[cols="1,5,5",stripes=even,options="header"]
|===
| #                                                                                                                                                                                                               | Goal                                                                                                                                                                                                            | Description
| 1                                                                                                                                                                                                               | A platform is uniquely identifiable                                                                                                                                                                             | A platform shall have an immutable identity that is both verifiable and attestable
| 2                                                                                                                                                                                                               | A platform shall only execute authorized software                                                                                                                                                               | A platform shall verify and authenticate any software before execution
| 3                                                                                                                                                                                                               | A platform shall support device bound storage                                                                                                                                                                   | A platform shall support a secure storage mechanism to store keys/ secrets that are tied to a particular platform (confidentiality & integrity protection of secret keys, integrity protection for public keys)
| 4                                                                                                                                                                                                               | A platform shall support secure TCB update                                                                                                                                                                      | A platform shall verify and authenticate any software image updates before loading/ storing/ executing them
| 5                                                                                                                                                                                                               | A platform shall prevent software version rollback                                                                                                                                                              | A platform shall prevent software version rollback with anti-rollback mechanism using techniques like monotonous counters
| 6                                                                                                                                                                                                               | A platform shall support security through its lifecycle                                                                                                                                                         | A platform shall support security through various lifecycle stages such as development, deployed, returned, end-of-life, etc
| 7                                                                                                                                                                                                               | A platform shall support isolation for code & data                                                                                                                                                              | A platform shall support both temporal and spatial isolation for security sensitive code and data
| 8                                                                                                                                                                                                               | A platform shall implement all zero-trust principles                                                                                                                                                            | See section 3
| 9                                                                                                                                                                                                               | A platform shall offer crypto services                                                                                                                                                                          | A platform shall offer classical crypto & optionally post-quantum crypto operations
| 10                                                                                                                                                                                                              | A platform shall protect customer sensitive data                                                                                                                                                                | A Platform shall offer confidentiality, integrity, and authenticity protection to sensitive data
| 11                                                                                                                                                                                                              | A platform shall establish its trustworthiness remotely                                                                                                                                                         | A platform shall be remotely attestable to prove its trustworthiness and security properties
| 12                                                                                                                                                                                                              | Security guidelines matched to product segment/ profile                                                                                                                                                         | A platform shall follow the security guidelines below to incorporate the right level of security for its product segment/ profile needs
| 13                                                                                                                                                                                                              | Software toolchains shall enforce security properties                                                                                                                                                           | A platform toolchain shall provide security, ex: C compiler when compiling to WebAssembly certain security features like stack canary are being omitted, and so the hardware cannot also protect
| 14                                                                                                                                                                                                              |                                                                                                                                                                                                                 |
|===



=== Adversary Model

The following are the adversary models we consider for this document:

[cols="1,5,5",stripes=even,options="header"]
|===
| #                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Adversary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Description
| 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Unprivileged Software Adversary                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | This includes software executing in U-mode. Application workloads are typically being managed by S/M-mode system software. This adversary can access U-mode CSRs, process/task memory, CPU registers in the process context.
| 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | System Software Adversary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | This includes system software executing in S and HS-modes. Such an adversary can access privileged CSRs, all of the system memory, CPU registers, and IO devices.
| 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Startup Code Adversary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | This includes system software executing in early/boot phases of the system, including BIOS, memory configuration code, device option ROM/firmware that can access system memory, CPU registers, IO devices, and IOMMU, etc.
| 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Simple Hardware Adversary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | This includes adversaries that can use hardware attacks such as bus interposers to snoop on memory/device interfaces, which may give the adversary the ability to tamper with data in memory.
| 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Advanced Hardware Adversary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | This includes adversaries that can use advanced hardware attacks, with unlimited physical access to the devices, and use mechanisms to tamper with the hardware TCB e.g., extract keys from hardware, using capabilities such as scanning electron microscopes, fib attacks, glitching attacks, etc.
| 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Side/ Covert Channel Adversary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | This includes adversaries that may leverage any explicit/implicit shared state (architectural or micro-architectural) to leak information across privilege boundaries via inference of characteristics from the shared resources (e.g. caches, branch prediction state, internal micro-architectural buffers, queues). Some attacks may require the use of high-precision timers to leak information. A combination of system software and hardware adversarial approaches may be utilized by this adversary.
|===
